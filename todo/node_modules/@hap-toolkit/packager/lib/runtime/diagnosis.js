"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _system=_interopRequireDefault(require("@system.fetch")),_system2=_interopRequireDefault(require("@system.device"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function initConsoleProxy(e){const o=new Function("return this")();["error","warn","info","log","debug","trace"].forEach(t=>{const s=o.console[t];o.console[t]=function(...n){s.apply(o.console,n),e(`console.${t}`,n)}}),console.info(""),console.info(""),console.info("### Quickapp Application Diagnosis Start ###")}function pipeToFetchFactory(e){let o,t,s,n={};_system2.default.getUserId({success(e){t=e.userId}}),_system2.default.getSerial({success(e){s=e.serial}}),_system2.default.getInfo({success(e){const{brand:o,manufacturer:t,model:s,product:r,osType:i,osVersionName:a,osVersionCode:c,platformVersionName:l,platformVersionCode:u}=e;n={brand:o,manufacturer:t,model:s,product:r,osType:i,osVersionName:a,osVersionCode:c,platformVersionName:l,platformVersionCode:u}}});const r=[];return function(i,a){r.push({time:Date.now(),type:i,args:a.map(e=>e&&e._id?Object.keys(e):e).map(e=>JSON.stringify(e))}),!o&&r.length>0&&(o=setTimeout(()=>{o=null;const i=r.splice(0);_system.default.fetch({url:e.url,method:"POST",data:{info:{deviceUserId:t,deviceSerialId:s,deviceInfo:n},list:i},header:{"Content-Type":"application/json"},success(){},fail(e){console.log(e)}})},1e3))}}function start(e){initConsoleProxy(pipeToFetchFactory({url:"http://"+e+"/data/log/save"}))}var _default=start;exports.default=_default;
//# sourceMappingURL=diagnosis.js.map
