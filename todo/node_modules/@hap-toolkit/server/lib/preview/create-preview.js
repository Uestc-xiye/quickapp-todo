"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=createPreview;var _path=_interopRequireDefault(require("path")),_koa=_interopRequireDefault(require("koa")),_koaMount=_interopRequireDefault(require("koa-mount")),_koaStatic=_interopRequireDefault(require("koa-static")),_createRouter=_interopRequireDefault(require("./create-router")),_shared=require("./shared");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}async function createPreview(e){const t=new _koa.default,r=_path.default.resolve(__dirname,"./static"),a=_path.default.resolve(__dirname,"./views/404.html");t.use((0,_koaMount.default)("/preview-static",(0,_koaStatic.default)(r))),t.use(async(e,t)=>{try{await t()}catch(t){console.error("CreatePreview Error :",t),e.status=404,e.type="text/html",e.body=await(0,_shared.renderPage)(a,{message:""})}});const u=await(0,_createRouter.default)(e);return t.use((0,_koaMount.default)("/preview",u.routes(),u.allowedMethods())),t}
//# sourceMappingURL=create-preview.js.map
